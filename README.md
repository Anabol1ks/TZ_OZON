# TZ_OZON ‚Äî –ú–æ–∫-—Å–µ—Ä–≤–∏—Å –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç (–¶–ë –†–§)

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å —ç–º—É–ª–∏—Ä—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ [–¶–ë –†–§ API](https://www.cbr.ru/scripts/XML_daily.asp?date_req=02/03/2002) –ø–æ –≤–æ–∑–≤—Ä–∞—Ç—É –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É. 

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –≠–º—É–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –¶–ë –†–§ (–∫–æ–¥ 200)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É (–∫–æ–¥ 500)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ XML-–æ—Ç–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ XML –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ proto-—Å—Ö–µ–º—ã (gRPC-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî –≤ –∑–∞–¥–µ–ª–µ –Ω–∞ –±—É–¥—É—â–µ–µ)
- Makefile –¥–ª—è —Å–±–æ—Ä–∫–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ protobuf –∏ –∑–∞–ø—É—Å–∫–∞ e2e —Ç–µ—Å—Ç–æ–≤
- –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ö–µ–Ω–¥–ª–µ—Ä–∞

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Go + Gin
- PostgreSQL + GORM
- Docker + Docker Compose
- Swagger (swaggo/gin-swagger)
- Protobuf
- Zap logger
- Testify –¥–ª—è —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤

---


## ‚öôÔ∏è –ó–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/Anabol1ks/TZ_OZON.git
cd TZ_OZON
```

### 2. –°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª

–°–∫–æ–ø–∏—Ä—É–π `.env.example` –≤ `.env` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```bash
copy .env.example .env  # Windows
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
make docker-up
# –∏–ª–∏
docker-compose -f docker-compose.yml up -d
```

### 4. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
make run
# –∏–ª–∏
go run cmd/main.go
```

### 5. Swagger –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:

http://localhost:8080/swagger/index.html

---

## üìå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å

```http
GET /scripts/XML_daily.asp?date_req=17/07/2025
```

–û—Ç–≤–µ—Ç: XML-–¥–æ–∫—É–º–µ–Ω—Ç —Å –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç

### –í–æ–∑–º–æ–∂–Ω–∞—è –æ—à–∏–±–∫–∞

–ò–Ω–æ–≥–¥–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–æ–≤–æ–π –¥–∞—Ç—ã, —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 50% –≤–µ—Ä–Ω—É—Ç—å 500 ‚Äî –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ API.

---


## üìÅ Makefile –∫–æ–º–∞–Ω–¥—ã

```bash
make run           # –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
make docker-up     # –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ docker-compose
make generate_proto # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è protobuf-—Ñ–∞–π–ª–æ–≤
make test          # –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ handler)
make e2e           # –∑–∞–ø—É—Å–∫ e2e —Ç–µ—Å—Ç–æ–≤ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
```

---


## üß™ –¢–µ—Å—Ç—ã

### –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã

–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è `GET /scripts/XML_daily.asp` –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç:

* –£—Å–ø–µ—à–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (200)
* –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `date_req` (400)
* –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã (400)

```bash
make test
# –∏–ª–∏
go test internal/handler/exchange_test.go
```

### E2E —Ç–µ—Å—Ç—ã

E2E —Ç–µ—Å—Ç—ã –∏–º–∏—Ç–∏—Ä—É—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–∏—Å—É —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ–±–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è: —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200) –∏ –æ—à–∏–±–∫—É (500).

> **–í–∞–∂–Ω–æ:** –î–ª—è –∑–∞–ø—É—Å–∫–∞ e2e —Ç–µ—Å—Ç–æ–≤ —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω (`make run` –∏–ª–∏ —á–µ—Ä–µ–∑ Docker Compose), –∏–Ω–∞—á–µ —Ç–µ—Å—Ç—ã –Ω–µ —Å–º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API.

–ó–∞–ø—É—Å–∫ e2e —Ç–µ—Å—Ç–æ–≤:

```bash
make e2e
# –∏–ª–∏
go test ./test/e2e/ -parallel 20 -count=1
```

–í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–∏—Å–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏.

---

## üõ∞ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ cmd/                  # main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
‚îÇ   ‚îú‚îÄ‚îÄ db/               # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ handler/          # –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Gin
‚îÇ   ‚îú‚îÄ‚îÄ logger/           # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è zap –ª–æ–≥–≥–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/           # GORM-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ router/           # –º–∞—Ä—à—Ä—É—Ç—ã + swagger
‚îú‚îÄ‚îÄ proto/                # proto-—Ñ–∞–π–ª—ã (gRPC)
‚îú‚îÄ‚îÄ tz_ozon/              # —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ protobuf-—Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Makefile
‚îî‚îÄ‚îÄ README.md
```

---

## üìö –ü—Ä–∏–º–µ—Ä gRPC –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (ExchangeService)

> –í –∑–∞–¥–µ–ª –Ω–∞ –±—É–¥—É—â–µ–µ, –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω proto-—Ñ–∞–π–ª `proto/exchange.proto`

```protobuf
service ExchangeService {
  rpc GetExchangeRate (ExchangeRateRequest) returns (ExchangeRateResponse);
}
```

---


## üßæ .env —Ñ–∞–π–ª (–ø—Ä–∏–º–µ—Ä)

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `.env.example`:

```env
DB_HOST=ozon-db
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=ozon12341
DB_NAME=ozon-db
DB_SSLMODE=disable
```

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è

* [x] –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç
* [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–æ–≤ 200 –∏ 500
* [x] –ë–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
* [x] Makefile
* [x] Protobuf —Ñ–∞–π–ª
* [x] Swagger
* [x] –ë–î
* [x] Go

---

## üìé –ê–≤—Ç–æ—Ä
[Anabol1ks](https://github.com/Anabol1ks)

